//------------------------------------librerias-----------------------------------------------------------
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdbool.h>
//------------------------------------funciones-----------------------------------------------------------
void jugar();
void explicación();
void facil(char nombre[20]); 
void medio(char nombre[20]);
void dificil(char nombre[20]);
void puntuacion();
//------------------------------------main-----------------------------------------------------------
int main(){
    int eleccion;
    system("clear");
    do
    {
        printf("UNO\n");
        printf("1. Nueva partida\n");
        printf("2. Puntuación\n");
        printf("3. Cómo jugar\n");
        printf("4. Salir\n");
        printf("Ingrese opción: ");
        scanf("%d", &eleccion);
        switch (eleccion)
        {
            case 1:
                jugar();
                break;
            case 2:
                puntuacion();
                break;
            case 3:
                explicación();
                break;
            case 4:
                printf("¡Hasta pronto!");
                break;
            default:
                system("clear");
                printf("Ingrese opción valida.\n");
                break;
        }
    } while (eleccion != 4);
    return 0;
}
//------------------------------------funciones_desarrolladas-----------------------------------------------------------
//_______________________________Interfaz principal__________________________________________
void jugar(){
    system("clear");
    bool salir = false;
    int eleccion;
    char nombre[20];
    printf("Ingrese nombre del jugador: ");
    scanf("%s", nombre);
    do  //elección de dificultad
    {
        printf("Dificultad: \n");
        printf("1. Facil: jugador vs pc\n");
        printf("2. Medio: jugador vs pc vs pc\n");
        printf("3. Dificil: jugador vs pc vs pc\n");
        printf("Seleccione dificultad: ");
        scanf("%d", &eleccion);
        switch (eleccion)
        {
        case 1:
            facil(nombre);
            salir = true;
            break;
        case 2:
            medio(nombre);
            salir = true;
            break;
        case 3:
            dificil(nombre);
            salir = true;
            break;
        default:
            system("clear");
            printf("Opción no valida.\n");
            break;
        }
        
    } while (salir != true);
    system("clear");
}
void explicación(){
    FILE *uno = fopen("cartas.dat", "r");
    if (uno == NULL)
    {
        printf("Ocurrio un problema al mostrar los sprites de cartas");
        return;
    }
    char linea[100];
    bool encontrado = false;
    system("clear");
    int salir;
    do
    {
        printf("1. ¿Cómo jugar al UNO?\n");
        printf("2. ¿Cómo es el sistema de puntos?\n");
        printf("3. Cartas especiales.\n");
        printf("4. Volver a pantalla de incio.\n");
        printf("Seleccione opción: ");
        scanf("%d", &salir);
        switch (salir)
        {
        case 1:
            system("clear");
            printf("El juego va a tener 3 modos de juego.\n");
            printf("facil: tu contra la maquina\n");
            printf("medio: tu contra 2 maquinas\n");
            printf("dificil: tu contra ¡3 maquinas!\n");
            printf("\n");
            printf("Cada jugador va a empezar con 7 cartas, el juego comienza contigo teniendo que poner una carta semejante a la que esta en la pila de descarte, pero... ¿En que se tienen que asemejar?\n");
            printf("En que deben de ser del mismo color o mismo numero, si no tienes ninguna de las dos debes de buscar si tienes cambio de color, si no tienes ninguna de estas opciones\n");
            printf("Debes de tomar una carta de la pila de robo. Cuando tengas unicamente una carta deberas de gritar uno, por lo contrario tendra que tomar 3 cartas de la pila de robo.\n");
            printf("¡El primer jugador en quedarse sin cartas va a ser el ganador!\n");
            printf("¡¡¡Mucha suerte!!!\n");
            printf("\n");
            break;
        case 2:
            system("clear");
            printf("¡La forma de obtener puntos es sencilla!\n");
            printf("Facil:\n");
            printf("-Por cada victoria obtendras +5 puntos\n");
            printf("-Por cada carta especial utilizada +2 puntos\n");
            printf("-Si evitas las cartas de +2 o +4 seran +4 puntos\n");
            printf("\n");
            printf("Medio:\n");
            printf("-Por cada victoria obtendras +10 puntos\n");
            printf("-Por cada carta especial utilizada +2 puntos\n");
            printf("-Si evitas las cartas de +2 o +4 seran +8 puntos\n");
            printf("\n");
            printf("Dificil:\n");
            printf("-Por cada victoria obtendras +20 puntos\n");
            printf("-Por cada carta especial utilizada +2 puntos\n");
            printf("-Si evitas las cartas de +2 o +4 seran +12 puntos\n");
            printf("\n");
            break;
        case 3:
            system("clear");
            while (fgets(linea, sizeof(linea), uno) != NULL)
            {
                if (strncmp(linea, "cartas especiales:", 2) == 0)
                {
                    encontrado = true;
                    continue;
                }
                if (encontrado == true)
                {
                    if (linea == NULL)
                    {
                        break;
                    }
                    printf("%s", linea);
                }   
            }
            printf("\n");
            break;
        default:
            system("clear");
            printf("seleccione una opción valida.\n");
            break;
        }
    } while (salir != 4);
    fclose(uno);
    system("clear");
}
void puntuacion(){
    system("clear");
    printf("Funciona eleccion 2\n");
    system("clear");
}
//_______________________dificultades____________________________________________________
void facil(char nombre[20]){
    system("clear");
    int seg = 3;
    printf("Funciona dificultad facil\n");
    while (seg > 0) //cuenta regresiva para que el jugador se prepare
    {
        printf("%d\n", seg);
        seg--;
        sleep(1);
    }
    system("clear");
}
void medio(char nombre[20]){
    system("clear");
    int seg = 3;
    printf("Funciona dificultad media\n");
    while (seg > 0) //cuenta regresiva para que el jugador se prepare
    {
        printf("%d\n", seg);
        seg--;
        sleep(1);
    }
    system("clear");
}
void dificil(char nombre[20]){
    system("clear");
    int seg = 3;
    printf("Funciona dificultad dificil\n");
    while (seg > 0) //cuenta regresiva para que el jugador se prepare
    {
        printf("%d\n", seg);
        seg--;
        sleep(1);
    }
    system("clear");
}
//_____________________________________________Creación archivos______________________________________
